# STATIC MALWARE ANALYSIS
<h2>${\textsf{\color{green}DESCRIPTION}}$</h2>
<a>
Static malware analysis is a method used in cybersecurity to dissect and understand malicious software without executing it. It involves examining the code or binary of a potentially harmful program to identify its behavior, functions, and potential threats. Analysts scrutinize the structure, syntax, and patterns within the code to uncover indicators of compromise, such as suspicious functions, obfuscated code, or known malware signatures. This approach allows cybersecurity professionals to assess the nature and potential impact of malware before it can wreak havoc on systems or networks, enabling proactive defense measures and informed decision-making to mitigate risks.</a>

<h2>${\textsf{\color{green}OBJECTIVES}}$</h2>
<body>
<ul>
<li>Identifying the file type (Target OS, architecture and format)</li>
<li>Identifying the malware (Generating a has of the malware and see if anyone else has analyzed the malware)</li>
<li>Strings (Give us an idea of what the malware can do)</li>
<li>Unpacking and deobfuscating to reveal information</li>
<li>PE Headers reveal a lot of information on the malware functionality.</li>
</ul>
</body>

<h2>${\textsf{\color{green}TOOLS}}$</h2>
<body>
  <ul>
    <li>HxD-Hex Editor</li>
    <li>PESTUDIO</li>
    <li>VIRUSTOTAL</li>
    <li>CFF EXPLORER</li>
  </ul>
</body>

<h2>${\textsf{\color{green}EXERCISE 1 IDENTIFYING THE MALWARE FILE TYPE}}$</h2>
<body>
<ol>
<li>Sample Acquisition: Obtain the malware sample from a reliable source. This could be through malware repositories, email attachments, infected files from compromised systems, or other sources.</li>
  <table>
    <tr>
      <th><img src="Image1.jpg"/><br><a>https://github.com/fabrimagic72/malware-samples/blob/master/Ransomware/%24ucyLocker/86e0eac8c5ce70c4b839ef18af5231b5f92e292b81e440193cdbdc7ed108049f.zip</a></th>
    </tr>
  </table><br>
<li>File Identification: Identify the file type and format of the malware sample. Common file types include executable files (EXE), dynamic link libraries (DLL), script files (VBS, JS), documents (DOC, PDF), and more.</li>
 <table>
    <tr>
      <th><img src="Image2.jpg"/><a>A PE32 executable refers to a Portable Executable (PE) file format used primarily in Windows operating systems for executables, DLLs (Dynamic Link Libraries), and device drivers. The "PE32" designation specifically refers to 32-bit Windows executables.</a></th>
    </tr>
  </table> 
  <li>File Analysis Tools: Utilize various tools to extract information from the malware sample without running it. These tools may include:</li>
  <ul>
    <li><b>Hex Editors:</b> Examine the binary content of the file to identify strings, headers, and other indicators.</li>
    <li><b>Disassemblers and Decompilers:</b> Disassemble executable files into assembly code or decompile high-level languages to understand the functionality of the malware.</li>
    <li><b>Debuggers:</b> Analyze the behavior of the malware by stepping through the code, setting breakpoints, and observing memory and register changes.</li>
    <li><b>Static Analysis Tools:</b> Use specialized static analysis tools to extract metadata, detect patterns, and identify malicious behavior within the malware sample.</li>
  </ul>
  <table>
    <tr>
      <td><img src="Image3.jpg"/></td>
    </tr>
    <tr>
      <th><img src="Image4.jpg"/></th>
    </tr>
    <tr>
    <th>The term "4D 5A" typically refers to the hexadecimal representation of the first two bytes in a Windows Portable Executable (PE) file. In the ASCII character encoding, these bytes correspond to the characters "MZ."
In the context of a file, "4D 5A" is often used to identify the file format as a Windows PE executable. These bytes serve as the "magic number" or "signature" that indicates the file is a valid Windows executable.
</th>
    </tr>
  </table><br>
  <body>
  <ul>
    <li><b>Footprint:</b><a>In simple terms, a malware footprint refers to the traces or indicators left behind by malware on a system or network. Just like footprints left in the sand can tell you that someone has been there, a malware footprint provides clues that malicious software has infiltrated a computer or network.</a></li>
    <table>
      <tr>
        <td><img src="Image5.jpg"/></td>
      </tr>
      <tr>
        <td><img src="Image6.jpg"/></td>
      </tr>
      <tr>
        <td><img src="Image7.jpg"/></td>
      </tr>
      <tr>
        <th>VirusTotal is a popular online service that analyzes files and URLs to detect malware and other types of malicious content. When you submit a file to VirusTotal for analysis, it performs a variety of checks using multiple antivirus engines and other detection mechanisms.</th>
      </tr>
      <tr>
        <td><img src="Image8.jpg"/><a>Detection Ratio: VirusTotal calculates the detection ratio, which indicates the number of antivirus engines that detected the file as malicious out of the total number of engines used for analysis. A high detection ratio suggests that the file is likely malicious.</a></td>
      </tr>
      <tr>
        <td><img src="Image9.jpg"/><a>Antivirus Engine Results: VirusTotal displays a list of antivirus engines used for analysis and their respective detection results. Each antivirus engine may classify the file as clean, malicious, suspicious, or unknown based on its own detection algorithms and definitions.</a></td>
      </tr>
      <tr>
        <td><img src="Image10.jpg"/><a>File Details: VirusTotal provides information about the file, such as its name, size, type, and cryptographic hash (MD5, SHA-1, SHA-256). This information helps identify the specific file being analyzed.</a></td>
      </tr>
      <tr>
        <td><img src="Image11.jpg"/></td>
      </tr>
      <tr>
        <td><img src="Image12.jpg"/></td>
        <td><img src="Image13.jpg"/></td>
      </tr>
      <tr>
        <th>Behavioral Information: In addition to static analysis, VirusTotal may provide behavioral information about the file's actions, such as its network activity, file system interactions, and process behavior. This information helps identify the file's behavior beyond simple static analysis.</th>
      </tr>
      <tr>
        <td><img src="Image14.jpg"/></td>
        <td><img src="Image15.jpg"/></td>
      </tr>
      <tr>
        <th>Additional Context: VirusTotal may provide additional context or metadata about the file, such as its origin, submission timestamp, and any associated URLs or domains. This information helps understand the context in which the file was encountered.</th>
      </tr>
    </table>
    <li>Strings:In static malware analysis, identifying and analyzing strings within the malware sample can provide valuable insights into its functionality, behavior, and intent.</li>
    <table>
      <tr>
        <td><img src="Image16.jpg"/></td>
      </tr>
      <tr>
        <th>File Extensions: Ransomware may include strings that specify the file extensions of encrypted files. These extensions are appended to the filenames of encrypted files to distinguish them from unencrypted files. Examples include:</th>
      </tr>
      <tr>
        <td>".locked"<br>".encrypted"<br>".crypt"<br</td>
      </tr>
      <tr>
        <th>Crypto-related Strings: Ransomware often includes strings related to cryptographic operations used for file encryption. These strings may include encryption algorithms, keys, initialization vectors, and other cryptographic parameters. Examples include:</th>
      </tr>
      <tr>
        <td>"AES-256"<br>"RSA"<br>"Initialization Vector (IV)"<br>"Decryption Key"</td>
      </tr>
    </table>
  </ul>
  <li>Code Analysis: Analyze the extracted code to understand the malware's functionality, behavior, and potential impact. This involves:</li>
  <table>
    <tr>
      <td><img src="Image17.jpg"/></td>
    </tr>
    <tr>
      <td><img src="Image18.jpg"/></td>
    </tr>
    <tr>
      <td><img src="Image19.jpg"/></td>
    </tr>
    <tr>
      <td><img src="Image20.jpg"/></td>
    </tr>
  </table>

  <li>IOCs in malware</li>
  <ul>
    <li>File Analysis: Extract metadata such as file size, file type, and file hashes (MD5, SHA-1, SHA-256).</li>
    <a><b>File Size:</b> 424448 bytes</a><br>
    <a><b>File Type:</b> Windows PE executable</a><br>
    <a><b>Malware original name:</b> VapeHacksLoader.exe</a><br>
    <a><b>MD5:</b> F34D5F2D4577ED6D9CEEC516C1F5A744</a><br>
    <a><b>SHA-256:</b> 86E0EAC8C5CE70C4B839EF18AF5231B5F92E292B81E440193CDBDC7ED108049F</a><br>
    <li>Strings Analysis: Extracted strings containing URLs, registry keys, and other potential IOCs.</li>
    <a>-http://inkscape.org</a><br>
    <a>-get_Bitcoin_Accepted_Here_4800px</a><br>
    <a>-Your computer is locked. Please do not close this window as that will result in serious computer damage.</a><br>
    <a>-Click next for more information and payment on how to get your files back.</a><br>
    <a>-Your Payment has failed, The funs have been sent back to your wallet. Please send it again</a><br>
    <li>File-Based IOCs:</li>
    <a>File Hashes: 86E0EAC8C5CE70C4B839EF18AF5231B5F92E292B81E440193CDBDC7ED108049F</a><br>
    <a>File Paths: C:\Users\Tyler\Desktop\hidden-tear-master\hidden-tear\hidden-tear\obj\Debug\VapeHacksLoader.pdb</a><br>
    <li>Network-Based IOCs:</li>
    <a>IP Address: TCP 104.86.182.43:443</a><br>
    <a>URL: www.inkscape.org</a><br>
    <li>MITRE Techniques</li>
    <a>T1027 | T1001 | T1055</a>
 </ul>
  <li><a href="https://github.com/FelipeINCA/STATICMALWAREANALYSIS/blob/main/MalwareReport.docx">FINAL MALWARE REPORT</a></li>
  </ol>
  </body>
  
